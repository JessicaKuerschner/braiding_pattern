<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our friend, MACHINE - Interactive Mindmap</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Hedvig+Letters+Serif:opsz@12..24&family=Space+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="mindmap.css">
</head>
<body>
    <nav class="top-nav">
        <a href="index.html" class="nav-link">MACHINE</a>
    </nav>
    
    <nav class="process-nav">
        <span class="process-link">PROCESS</span>
    </nav>
    
    <!-- Side Week Navigation -->
    <div class="side-week-nav">
        <div class="week-item" data-week="week1">
            <span class="week-name">SETTING UP</span>
        </div>
        <div class="week-item" data-week="week2">
            <span class="week-name">BRAIDING MACHINE & EXPERIMENTS</span>
        </div>
        <div class="week-item" data-week="week3">
            <span class="week-name">MATERIAL TESTING & ANALYSIS</span>
        </div>
        <div class="week-item" data-week="week4">
            <span class="week-name">PATTERN DEVELOPMENT</span>
        </div>
        <div class="week-item" data-week="week5">
            <span class="week-name">PROTOTYPE CREATION</span>
        </div>
        <div class="week-item" data-week="week6">
            <span class="week-name">TESTING & REFINEMENT</span>
        </div>
        <div class="week-item" data-week="week7">
            <span class="week-name">DOCUMENTATION & PRESENTATION</span>
        </div>
        <div class="week-item" data-week="week8">
            <span class="week-name">DUTCH DESIGN WEEK INTEGRATION</span>
        </div>
        <div class="week-item" data-week="week9">
            <span class="week-name">SOCIAL DANCE & DIGITAL INTEGRATION</span>
        </div>
    </div>
    
    <!-- Week Content Overlay -->
    <div class="week-overlay" id="week-overlay">
        <div class="overlay-content" id="overlay-content">
            <div class="overlay-close" id="overlay-close">×</div>
            <!-- Week content will be loaded here -->
        </div>
    </div>
    
    <div class="mindmap-container">

        <!-- Week 1 Tools & Setup -->
        <div class="node setup-node docs-node" data-node="docs" data-connects="central,abstract">
            <div class="node-content">
                <h3>Collaborative Writing</h3>
            </div>
        </div>

        <div class="node setup-node zotero-node" data-node="zotero" data-connects="central,reenchantment,community">
            <div class="node-content">
                <h3>Research Sources</h3>
            </div>
        </div>

        <div class="node setup-node figma-node" data-node="figma" data-connects="central,mindmap">
            <div class="node-content">
                <h3>Design Layouts</h3>
            </div>
        </div>

        <!-- Research Questions -->
        <div class="node research-node marion-research-node" data-node="reenchantment" data-connects="zotero,rope,mechanism">
            <div class="node-content">
                <h3>Research Questions</h3>
            </div>
        </div>

        <div class="node research-node jess-research-node" data-node="community" data-connects="zotero,rope,textile">
            <div class="node-content">
                <h3>Material Objectives</h3>
            </div>
        </div>

        <!-- Material Focus -->
        <div class="node material-node rope-node" data-node="rope" data-connects="central,companies">
            <div class="node-content">
                <h3>Rope Making</h3>
            </div>
        </div>

        <!-- Week 2 Making Activities -->
        <div class="node making-node braiding-machine-node" data-node="mechanism" data-connects="reenchantment,motor,texmind">
            <div class="node-content">
                <h3>Printing Components</h3>
            </div>
        </div>

        <div class="node making-node textile-experiments-node" data-node="textile" data-connects="community,maypole">
            <div class="node-content">
                <h3>Braiding Techniques</h3>
            </div>
        </div>

        <div class="node making-node motor-node" data-node="motor" data-connects="mechanism">
            <div class="node-content">
                <h3>Component Testing</h3>
            </div>
        </div>

        <!-- Software & Tools -->
        <div class="node software-node texmind-node" data-node="texmind" data-connects="mechanism,automation">
            <div class="node-content">
                <h3>Sponsorship</h3>
            </div>
        </div>

        <div class="node software-node herzog-node" data-node="automation" data-connects="texmind">
            <div class="node-content">
                <h3>Corbeo Contact</h3>
            </div>
        </div>

        <!-- Community Connections -->
        <div class="node community-node maypole-node" data-node="maypole" data-connects="textile,gabriel">
            <div class="node-content">
                <h3>Maypole Workshop</h3>
            </div>
        </div>

        <div class="node community-node gabriel-node" data-node="gabriel" data-connects="maypole">
            <div class="node-content">
                <h3>Pattern Formation</h3>
            </div>
        </div>

        <div class="node community-node rope-companies-node" data-node="companies" data-connects="rope">
            <div class="node-content">
                <h3>Factory Visit</h3>
            </div>
        </div>

        <!-- Research Outputs -->
        <div class="node output-node mindmap-node" data-node="mindmap" data-connects="abstract,figma">
            <div class="node-content">
                <h3>Shared Mindmap</h3>
            </div>
        </div>

        <div class="node output-node abstract-node" data-node="abstract" data-connects="docs">
            <div class="node-content">
                <h3>Dance Schematics</h3>
            </div>
        </div>

        <!-- Image Elements -->
        <div class="image-element image-1">
            <img src="images/week1collabpic.jpg" alt="Collaboration" class="mindmap-image">
        </div>
        
        <div class="image-element image-2">
            <img src="images/Week1MindmapPostits.jpeg" alt="Mindmap Postits" class="mindmap-image">
        </div>
        
        <div class="image-element image-3">
            <img src="images/IMG_0050.JPG" alt="3D Machine" class="mindmap-image">
        </div>
        
        <div class="image-element image-4">
            <img src="images/IMG_0133.JPG" alt="Textile Work" class="mindmap-image">
        </div>
        
        <div class="image-element image-5">
            <img src="images/IMG_0141.JPG" alt="Rope Material" class="mindmap-image">
        </div>
        
        <div class="image-element image-6">
            <img src="images/IMG_0148.JPG" alt="Documentation" class="mindmap-image">
        </div>

        <!-- Connection Lines -->
        <svg class="connections" width="100%" height="100%">
            <!-- Lines will be dynamically generated -->
        </svg>


    </div>

    <script src="mindmap.js"></script>
    <script>
        // Mindmap dragging functionality
        let isDragging = false;
        let dragStartX = 0;
        let dragStartY = 0;
        let currentTranslateX = 0;
        let currentTranslateY = 0;
        
        document.addEventListener('DOMContentLoaded', function() {
            const mindmapContainer = document.querySelector('.mindmap-container');
            
            // Mouse down to start dragging
            mindmapContainer.addEventListener('mousedown', function(e) {
                // Don't drag if clicking on a node
                if (e.target.closest('.node')) return;
                
                isDragging = true;
                dragStartX = e.clientX - currentTranslateX;
                dragStartY = e.clientY - currentTranslateY;
                mindmapContainer.classList.add('dragging');
                e.preventDefault();
            });
            
            // Mouse move to drag
            document.addEventListener('mousemove', function(e) {
                if (!isDragging) return;
                
                currentTranslateX = e.clientX - dragStartX;
                currentTranslateY = e.clientY - dragStartY;
                
                mindmapContainer.style.transform = `translate(${currentTranslateX}px, ${currentTranslateY}px)`;
            });
            
            // Mouse up to stop dragging
            document.addEventListener('mouseup', function() {
                if (isDragging) {
                    isDragging = false;
                    mindmapContainer.classList.remove('dragging');
                }
            });
            
            // Touch events for mobile
            mindmapContainer.addEventListener('touchstart', function(e) {
                if (e.target.closest('.node')) return;
                
                isDragging = true;
                const touch = e.touches[0];
                dragStartX = touch.clientX - currentTranslateX;
                dragStartY = touch.clientY - currentTranslateY;
                mindmapContainer.classList.add('dragging');
                e.preventDefault();
            });
            
            document.addEventListener('touchmove', function(e) {
                if (!isDragging) return;
                
                const touch = e.touches[0];
                currentTranslateX = touch.clientX - dragStartX;
                currentTranslateY = touch.clientY - dragStartY;
                
                mindmapContainer.style.transform = `translate(${currentTranslateX}px, ${currentTranslateY}px)`;
                e.preventDefault();
            });
            
            document.addEventListener('touchend', function() {
                if (isDragging) {
                    isDragging = false;
                    mindmapContainer.classList.remove('dragging');
                }
            });
        });
        
        // Week navigation functionality
        document.addEventListener('DOMContentLoaded', function() {
            const weekItems = document.querySelectorAll('.week-item');
            const overlay = document.getElementById('week-overlay');
            const overlayContent = document.getElementById('overlay-content');
            const overlayClose = document.getElementById('overlay-close');
            
            // Week content data
            const weekContent = {
                week1: {
                    title: "WEEK 1: ORGANIZATIONAL GROUNDWORK",
                    content: `
                        <h3>Organizational Groundwork</h3>
                        <p>In the first week, we established the organizational structure for the project. Google Docs was used for collaborative writing, Zotero for compiling and referencing research sources, and Figma for testing website and design layouts before coding. We created a shared mindmap to organize key concepts, linking research on rope-making, community practices, and industrial labor to our project focus. This groundwork also helped define individual research questions and clarify material experimentation objectives.</p>
                    `
                },
                week2: {
                    title: "WEEK 2: PRINTING & MATERIAL EXPLORATION",
                    content: `
                        <h3>Printing & Material Exploration</h3>
                        <p>Work began on printing components for an open-source 3D braiding machine. While printing took longer than expected, the process allowed us to test initial parts and identify necessary adjustments. Concurrently, sponsorship requests were sent to Corbeo to support future factory visits. I also conducted preliminary textile experiments with rope, exploring basic braiding techniques, volumetric forms through tying, and weaving-like structures to understand the material's possibilities.</p>
                    `
                },
                week3: {
                    title: "WEEK 3: MAYPOLE WORKSHOP PREPARATION",
                    content: `
                        <h3>Maypole Workshop Preparation</h3>
                        <p>Preparation for a Maypole workshop included designing structural supports and applying textiles to poles. Participants were organized, and research into Maypole traditions and dances was conducted to understand the social and communal aspects of the practice. The research focus and graduation plan were updated based on insights gained, including potential links between physical interaction, pattern formation, and collective participation.</p>
                    `
                },
                week4: {
                    title: "WEEK 4: CONNECTING THROUGH SEAMS",
                    content: `
                        <h3>Connecting Through Seams</h3>
                        <p>During the "Connecting Through Seams" workshop at Het Nieuwe Instituut, we explored the interaction of movement, pattern, and collaboration through Maypole dancing. Schematics of the dances were documented, and participants engaged in structured exercises that revealed how rhythm and repetition shape group behavior and social coordination.</p>
                    `
                },
                week5: {
                    title: "WEEK 5: CORBEO FACTORY VISIT",
                    content: `
                        <h3>Corbeo Factory Visit</h3>
                        <p>We visited the Corbeo rope factory in Belgium. On the production floor, few human operators are required, as most processes are automated. However, in the rope braiding section, human intervention remains critical. One operator manages multiple machines—winding, unwinding, and braiding—and performs precise tasks such as tying old yarns to new ones, cutting yarn from spools, and integrating new threads into the rope. An engineer explained the mechanical functions of the machines and how rope-making techniques have evolved across three generations.</p>
                    `
                },
                week6: {
                    title: "WEEK 6: SOCIAL OBSERVATION & EXPERIMENTATION",
                    content: `
                        <h3>Social Observation & Experimentation</h3>
                        <p>This week focused on observing social interaction and material experimentation. At the Tilburg Textile Museum, we explored ways to present rope-making techniques in a simple and accessible manner. The goal was to create an inviting experience where visitors could understand and engage with the material, potentially taking something home. Techniques such as "Vlechten," "Gimpen," and "Koorddraien" were showcased, highlighting different volumes, forms, and possibilities for hollow or split structures. The installation was designed to be movable and interactive, functioning both as an archive of past work and as a platform for experimentation.</p>
                        
                        <p>We also conducted a Maypole workshop to test community-driven patterns and structures. We experimented with horizontal and multiple poles, and different rope thicknesses to explore architectural and spatial possibilities. The activity emphasized collaboration, as participants collectively shaped patterns and volumes. Observations included how color and material choices could reflect individual contributions, how movement and timing affected pattern formation, and how structured interaction can generate social cohesion.</p>
                        
                        <p>Additionally, we attended a Balfolk dance session at Café Wilhelmina in Eindhoven to observe structured social interaction through rhythm and shared etiquette. Some dances were calm and slow, while others were faster and more energetic. This provided insight into how structured movement and rhythm can foster connection among participants and inform the design of interactive systems.</p>
                    `
                },
                week7: {
                    title: "WEEK 7: MACHINE DEVELOPMENT",
                    content: `
                        <h3>Machine Development</h3>
                        <p>This week focused on machine development. Parts for the braiding machine were ordered, and a CNC machine was requested to facilitate precise manufacturing. A component was constructed using a combination of wood and 3D printing to test mechanical movement and feasibility. The emphasis was on integrating digital modeling with physical fabrication to refine the machine's functionality.</p>
                    `
                },
                week8: {
                    title: "WEEK 8: DUTCH DESIGN WEEK INTEGRATION",
                    content: `
                        <h3>Dutch Design Week Integration</h3>
                        <p>During Dutch Design Week, multiple project elements were developed in parallel. We created a mechanism for connecting rings in the machine and built an interactive website featuring a pattern-maker tool. Documentation of user interaction scenarios was developed, including how physical and digital actions could influence outcomes. Existing machines were analyzed to identify unnecessary complexity and inform simplifications. A first video documenting the mid-term presentation was produced, sponsorship from Gimmex was secured, and the initial switchcam and spools were assembled.</p>
                    `
                },
                week9: {
                    title: "WEEK 9: SOCIAL DANCE & DIGITAL INTEGRATION",
                    content: `
                        <h3>Social Dance & Digital Integration</h3>
                        <p>We focused on integrating social dance insights with digital interaction through the website. Feedback from advisors informed revisions to both the coding and physical mechanisms. A CNC component was tested on the machine, and a rotating attachment for lampposts was constructed from metal. Preparations for the mid-term presentation included organizing documentation, refining demonstration materials, and reviewing interaction scenarios for both physical and online users.</p>
                    `
                }
            };
            
            // Click to open overlay
            weekItems.forEach(item => {
                item.addEventListener('click', function() {
                    const weekId = this.dataset.week;
                    const content = weekContent[weekId];
                    
                    if (content) {
                        overlayContent.innerHTML = `
                            <h2>${content.title}</h2>
                            ${content.content}
                        `;
                        overlay.classList.add('active');
                    }
                });
            });
            
            // Close overlay
            overlayClose.addEventListener('click', function() {
                overlay.classList.remove('active');
            });
            
            // Close overlay on background click
            overlay.addEventListener('click', function(e) {
                if (e.target === overlay) {
                    overlay.classList.remove('active');
                }
            });
            
            // Close overlay with Escape key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    overlay.classList.remove('active');
                }
            });
            
            // Node click functionality
            const nodes = document.querySelectorAll('.node');
            nodes.forEach(node => {
                node.addEventListener('click', function(e) {
                    e.stopPropagation(); // Prevent dragging
                    
                    const nodeType = this.dataset.node;
                    const weekInfo = getWeekForNode(nodeType);
                    
                    if (weekInfo) {
                        showNodeWeek(weekInfo);
                    }
                });
            });
            
            function getWeekForNode(nodeType) {
                const nodeWeekMap = {
                    'docs': { week: 1, title: 'WEEK 1', activity: 'Google Docs Setup' },
                    'zotero': { week: 1, title: 'WEEK 1', activity: 'Zotero Research Management' },
                    'figma': { week: 1, title: 'WEEK 1', activity: 'Figma Design Tools' },
                    'reenchantment': { week: 1, title: 'WEEK 1', activity: 'Research Question: Reenchantment' },
                    'community': { week: 1, title: 'WEEK 1', activity: 'Research Question: Community Power' },
                    'rope': { week: 1, title: 'WEEK 1', activity: 'Material Focus: Rope' },
                    'mechanism': { week: 2, title: 'WEEK 2', activity: '3D Printed Braiding Machine' },
                    'textile': { week: 2, title: 'WEEK 2', activity: 'Textile Experiments' },
                    'motor': { week: 2, title: 'WEEK 2', activity: 'Motor Integration from Emmaus' },
                    'texmind': { week: 2, title: 'WEEK 2', activity: 'Texmind Software Exploration' },
                    'automation': { week: 2, title: 'WEEK 2', activity: 'Herzog Automation System' },
                    'maypole': { week: 2, title: 'WEEK 2', activity: 'Maypole Tradition Research' },
                    'gabriel': { week: 2, title: 'WEEK 2', activity: 'Gabriel Fontana Collaboration' },
                    'companies': { week: 3, title: 'WEEK 3', activity: 'Rope Companies Research' },
                    'mindmap': { week: 1, title: 'WEEK 1', activity: 'Research Mindmap Creation' },
                    'abstract': { week: 1, title: 'WEEK 1', activity: 'Updated Project Abstract' }
                };
                
                return nodeWeekMap[nodeType] || null;
            }
            
            function showNodeWeek(weekInfo) {
                // Clear any existing labels
                document.querySelectorAll('.week-line-label').forEach(label => {
                    label.remove();
                });
                
                // Find the clicked node
                const clickedNode = event.target.closest('.node');
                if (!clickedNode) return;
                
                const nodeType = clickedNode.dataset.node;
                const connections = clickedNode.dataset.connects;
                
                if (connections) {
                    const connectedNodes = connections.split(',');
                    
                    connectedNodes.forEach(connectedNodeType => {
                        const connectedNode = document.querySelector(`[data-node="${connectedNodeType.trim()}"]`);
                        if (connectedNode) {
                            // Calculate midpoint of the connection line
                            const clickedRect = clickedNode.getBoundingClientRect();
                            const connectedRect = connectedNode.getBoundingClientRect();
                            const containerRect = document.querySelector('.mindmap-container').getBoundingClientRect();
                            
                            const clickedX = clickedRect.left + clickedRect.width / 2 - containerRect.left;
                            const clickedY = clickedRect.top + clickedRect.height / 2 - containerRect.top;
                            const connectedX = connectedRect.left + connectedRect.width / 2 - containerRect.left;
                            const connectedY = connectedRect.top + connectedRect.height / 2 - containerRect.top;
                            
                            const midX = (clickedX + connectedX) / 2;
                            const midY = (clickedY + connectedY) / 2;
                            
                            // Create label positioned at midpoint of connection line
                            const label = document.createElement('div');
                            label.className = 'week-line-label active';
                            label.textContent = weekInfo.title;
                            
                            label.style.left = midX + 'px';
                            label.style.top = midY + 'px';
                            label.style.transform = 'translate(-50%, -50%)';
                            
                            document.querySelector('.mindmap-container').appendChild(label);
                        }
                    });
                }
                
                // Auto remove after 3 seconds
                setTimeout(() => {
                    document.querySelectorAll('.week-line-label').forEach(label => {
                        label.classList.remove('active');
                        setTimeout(() => label.remove(), 300);
                    });
                }, 3000);
            }
        });
        
        // Multi-user color system
        class MultiUserColorSystem {
            constructor() {
                this.userId = this.generateUserId();
                this.users = [];
                this.colorRanges = [
                    { hue: 0, name: 'red' },      // Red
                    { hue: 30, name: 'orange' },   // Orange
                    { hue: 60, name: 'yellow' },   // Yellow
                    { hue: 120, name: 'green' },   // Green
                    { hue: 180, name: 'cyan' },    // Cyan
                    { hue: 240, name: 'blue' },    // Blue
                    { hue: 270, name: 'purple' },  // Purple
                    { hue: 300, name: 'magenta' }, // Magenta
                    { hue: 15, name: 'coral' },    // Coral
                    { hue: 45, name: 'gold' },     // Gold
                    { hue: 90, name: 'lime' },     // Lime
                    { hue: 150, name: 'teal' },    // Teal
                ];
                this.init();
            }
            
            generateUserId() {
                return 'user_' + Math.random().toString(36).substr(2, 9);
            }
            
            init() {
                // Simulate initial users (you can replace this with real WebSocket connection)
                this.simulateUsers();
                this.updateImageFilters();
                this.showUserInfo();
                
                // Simulate users joining/leaving periodically
                setInterval(() => {
                    this.simulateUserChange();
                }, 10000); // Every 10 seconds
            }
            
            simulateUsers() {
                // Start with 1-3 random users
                const initialUserCount = Math.floor(Math.random() * 3) + 1;
                for (let i = 0; i < initialUserCount; i++) {
                    this.addUser(this.generateUserId());
                }
                // Add current user
                this.addUser(this.userId);
            }
            
            simulateUserChange() {
                // Randomly add or remove users
                if (Math.random() > 0.5 && this.users.length < 12) {
                    // Add user
                    this.addUser(this.generateUserId());
                } else if (this.users.length > 1) {
                    // Remove user (but not current user)
                    const otherUsers = this.users.filter(u => u.id !== this.userId);
                    if (otherUsers.length > 0) {
                        const userToRemove = otherUsers[Math.floor(Math.random() * otherUsers.length)];
                        this.removeUser(userToRemove.id);
                    }
                }
            }
            
            addUser(userId) {
                if (!this.users.find(u => u.id === userId)) {
                    const colorIndex = this.users.length % this.colorRanges.length;
                    const user = {
                        id: userId,
                        color: this.colorRanges[colorIndex],
                        isCurrentUser: userId === this.userId
                    };
                    this.users.push(user);
                    this.updateImageFilters();
                    this.showUserInfo();
                    console.log(`User ${userId} joined with ${user.color.name} filter`);
                }
            }
            
            removeUser(userId) {
                this.users = this.users.filter(u => u.id !== userId);
                this.updateImageFilters();
                this.showUserInfo();
                console.log(`User ${userId} left`);
            }
            
            updateImageFilters() {
                // Image filters removed - images display normally in grayscale via CSS
            }
            
            createMultiUserOverlays(imageElement, originalImg) {
                // Multi-user overlay feature removed
            }
            
            getHueShiftForColor(userHue) {
                return 0;
            }
            
            createColorMasks() {
                // Color mask feature removed
            }
            
            getCombinedColorFilter() {
                return '';
                
                // Add sepia effect that decreases with more users (simulating color revelation)
                const sepiaAmount = Math.max(0.8 - (userCount * 0.15), 0);
                combinedFilter += ` sepia(${sepiaAmount})`;
                
                return combinedFilter;
            }
            
            createColorSelectionMatrix() {
                // Simplified approach - in practice this would be more complex
                const userCount = this.users.length;
                return Math.min(userCount * 0.2, 1);
            }
            
            getColorFromHue(hue) {
                // Convert HSL to RGB for glow effect
                const h = hue / 360;
                const s = 0.7;
                const l = 0.5;
                
                const hue2rgb = (p, q, t) => {
                    if (t < 0) t += 1;
                    if (t > 1) t -= 1;
                    if (t < 1/6) return p + (q - p) * 6 * t;
                    if (t < 1/2) return q;
                    if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
                    return p;
                };
                
                const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                const p = 2 * l - q;
                const r = Math.round(hue2rgb(p, q, h + 1/3) * 255);
                const g = Math.round(hue2rgb(p, q, h) * 255);
                const b = Math.round(hue2rgb(p, q, h - 1/3) * 255);
                
                return `rgba(${r}, ${g}, ${b}, 0.3)`;
            }
            
            showUserInfo() {
                // Create or update user info display
                // User info display removed
            }
        }
        
        
        // Initialize the multi-user system
        const colorSystem = new MultiUserColorSystem();
    </script>
</body>
</html>